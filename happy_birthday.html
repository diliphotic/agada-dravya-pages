<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Premium Interactive Cake â€” Shweta (Pro)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-1:#031024;--bg-2:#071428;--glass:rgba(255,255,255,0.04);
      --accent:#ff6b6b;--accent2:#ffd166;--gold:#f5c06b;--cream:#fff5e6;--choc:#6b3520;
      --muted:rgba(230,238,248,0.72);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(900px 420px at 12% 10%, rgba(255,107,107,0.035), transparent), linear-gradient(180deg,var(--bg-1), #041020 80%);font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;color:#f3f9ff}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:36px}

    /* Layout card */
    .card{width:1120px;max-width:96vw;border-radius:22px;padding:22px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);box-shadow:0 30px 90px rgba(2,6,23,0.75);display:grid;grid-template-columns:620px 1fr;gap:24px;align-items:stretch}

    /* Left: immersive cake stage */
    .stage{background:linear-gradient(180deg,var(--bg-2), #041227);border-radius:14px;padding:18px;position:relative;overflow:hidden}
    .stage-head{display:flex;align-items:center;gap:14px}
    .title{font-family:'Playfair Display',serif;font-size:20px;font-weight:700}
    .subtitle{font-size:13px;color:var(--muted)}

    .scene{margin-top:10px;display:flex;align-items:center;justify-content:center;height:520px;position:relative}
    .cake-plate{width:560px;height:420px;position:relative}

    /* cake container: center responsive */
    .cake-wrap{position:absolute;left:50%;top:50%;transform:translate(-50%,-48%);width:420px;height:300px;pointer-events:auto}

    /* realistic layers using gradients + SVG mask for curved edge */
    .layer-wrap{position:absolute;left:0;top:0;width:100%;height:100%}
    .layer-base{position:absolute;left:0;right:0;border-radius:36px;height:68px;background:linear-gradient(180deg,#7b3f2a,#5a2817);box-shadow:inset 0 -16px 30px rgba(0,0,0,0.45)}
    .layer-mid{position:absolute;left:12px;right:12px;height:68px;border-radius:28px;background:linear-gradient(180deg,#f3d2c0,#e4a88a);top:68px;box-shadow:inset 0 -10px 20px rgba(0,0,0,0.35)}
    .layer-top{position:absolute;left:24px;right:24px;height:68px;border-radius:24px;background:linear-gradient(90deg,var(--cream),#ffeccf);top:136px;box-shadow:inset 0 -8px 18px rgba(0,0,0,0.25)}

    /* chocolate drip decorative */
    .drip{position:absolute;left:24px;right:24px;top:116px;height:44px;border-radius:22px;background:linear-gradient(180deg,#3f1f12,#2b140a);opacity:0.95}

    /* icing and decor */
    .icing{position:absolute;left:28px;right:28px;top:92px;height:28px;border-radius:22px;background:linear-gradient(90deg,#fff6e6,#ffe2b8);box-shadow:0 10px 26px rgba(0,0,0,0.2)}

    /* candle group */
    .candles{position:absolute;left:50%;top:28px;transform:translateX(-50%);display:flex;gap:10px}
    .candle{width:12px;height:40px;border-radius:8px;background:linear-gradient(180deg,#fff8d9,#fff1b3);display:flex;align-items:flex-start;justify-content:center}
    .flame{width:8px;height:10px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#fff6b8,#ffd166 40%,#ff7b6b 80%);margin-top:-6px;box-shadow:0 12px 34px rgba(255,110,75,0.5);animation:flame 900ms infinite}
    @keyframes flame{0%{transform:translateY(0)}50%{transform:translateY(-2px) scale(1.02)}100%{transform:translateY(0)}}

    /* plate and shadow */
    .plate-shadow{position:absolute;left:50%;bottom:12px;transform:translateX(-50%);width:620px;height:84px;border-radius:999px;box-shadow:0 40px 110px rgba(2,6,23,0.6);filter:blur(12px);opacity:.8}

    /* UX hints overlay */
    .hint{position:absolute;left:18px;bottom:18px;background:linear-gradient(90deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));padding:8px 12px;border-radius:10px;font-size:13px;color:var(--muted);backdrop-filter:blur(6px)}

    /* interactive slice + physics-ish animation */
    .slice{position:absolute;pointer-events:none;width:160px;height:220px;left:50%;top:20%;transform:translate(-50%,0);opacity:0}
    .slice svg{display:block}

    /* halves clipped by JS using clip-path */
    .half{position:absolute;top:0;bottom:0;overflow:visible;left:0}

    /* confetti and balloons absolute layers */
    .confetti, .balloons{position:absolute;inset:0;pointer-events:none;z-index:80}

    /* right panel */
    .panel{padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);display:flex;flex-direction:column;gap:14px}
    .wish{flex:1;border-radius:12px;background:linear-gradient(180deg,#071428,#052032);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;position:relative;overflow:hidden}
    .wish h1{font-family:'Playfair Display',serif;font-size:36px;margin:0;color:var(--gold);opacity:0;transform:translateY(12px) scale(.98);transition:all .9s cubic-bezier(.2,.9,.2,1)}
    .wish p{margin:6px 0 0 0;color:var(--muted);opacity:0;transform:translateY(8px);transition:all .9s .12s cubic-bezier(.2,.9,.2,1)}

    /* controls */
    .controls{display:flex;gap:10px;flex-wrap:wrap}
    .btn{padding:10px 14px;border-radius:12px;border:none;cursor:pointer;font-weight:700}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#ff8a8a);color:#081025}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

    /* show states */
    .reveal .wish h1{opacity:1;transform:none}
    .reveal .wish p{opacity:1;transform:none}

    /* responsive */
    @media (max-width:980px){.card{grid-template-columns:1fr;}.scene{height:420px}.cake-wrap{transform:translate(-50%,-42%);width:360px;height:260px}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="card">
      <div class="stage" aria-label="Interactive cake stage">
        <div class="stage-head">
          <div>
            <div class="title">Happy Birthday, Shweta â€” Premium Experience</div>
            <div class="subtitle">Touch / Click the cake to cut. Drag to change slice angle. Enjoy realistic response, sound & export.</div>
          </div>
        </div>

        <div class="scene">
          <div class="cake-plate" id="cakePlate">
            <div class="cake-wrap" id="cakeWrap">
              <div class="layer-wrap">
                <div class="half" id="halfLeft" style="clip-path:polygon(0 0,50% 0,50% 100%,0 100%)">
                  <div class="layer-base" style="transform:translateX(6px)"></div>
                  <div class="layer-mid" style="transform:translateX(6px)"></div>
                  <div class="layer-top" style="transform:translateX(6px)"></div>
                </div>
                <div class="half" id="halfRight" style="clip-path:polygon(50% 0,100% 0,100% 100%,50% 100%)">
                  <div class="layer-base" style="transform:translateX(-6px)"></div>
                  <div class="layer-mid" style="transform:translateX(-6px)"></div>
                  <div class="layer-top" style="transform:translateX(-6px)"></div>
                </div>

                <div class="drip" aria-hidden="true"></div>
                <div class="icing" aria-hidden="true"></div>

                <div class="slice" id="slice">
                  <!-- stylized slice SVG (flying piece) -->
                  <svg width="160" height="220" viewBox="0 0 120 170" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                      <linearGradient id="g1" x1="0" x2="0" y1="0" y2="1">
                        <stop offset="0%" stop-color="#fff4dd"/>
                        <stop offset="100%" stop-color="#ffd9af"/>
                      </linearGradient>
                      <linearGradient id="g2" x1="0" x2="0" y1="0" y2="1">
                        <stop offset="0%" stop-color="#f6d6c2"/>
                        <stop offset="100%" stop-color="#e7b297"/>
                      </linearGradient>
                    </defs>
                    <path d="M60 6 C52 6, 18 22, 12 44 C8 58, 16 66, 16 66 L104 66 C104 66, 112 58, 108 44 C102 22, 68 6, 60 6 Z" fill="url(#g1)" stroke="#e8c99e" stroke-width="1"/>
                    <path d="M16 66 L60 160 L104 66 Z" fill="url(#g2)" stroke="#d1a07f" stroke-width="1"/>
                  </svg>
                </div>

                <div class="candles" aria-hidden="true">
                  <div class="candle"><div class="flame"></div></div>
                  <div class="candle"><div class="flame"></div></div>
                  <div class="candle"><div class="flame"></div></div>
                </div>
              </div>
            </div>

            <div class="plate-shadow" aria-hidden="true"></div>

            <div class="confetti" id="confetti"></div>
            <div class="balloons" id="balloons"></div>
            <div class="hint">Tip: Click where you want the slice â€” drag slightly to adjust angle.</div>
          </div>
        </div>

        <div style="display:flex;gap:10px;margin-top:10px;align-items:center">
          <button class="btn primary" id="downloadBtn">Export eâ€‘card</button>
          <button class="btn ghost" id="soundToggle">Mute</button>
          <button class="btn ghost" id="fullBtn">Fullscreen</button>
        </div>
      </div>

      <div class="panel">
        <div class="wish" id="wish">
          <h1 id="wishTitle">Happy Birthday, Shweta ðŸŽ‚</h1>
          <p id="wishText">May your day be golden â€” full of laughter, love and memorable slices.</p>
        </div>

        <div class="controls">
          <button class="btn ghost" id="reset">Reset</button>
          <button class="btn ghost" id="randomize">Random Theme</button>
          <button class="btn primary" id="share">Share</button>
        </div>

        <div style="margin-top:8px;color:var(--muted);font-size:13px">Pro features included: realistic slice physics, crumb particles, confetti physics, balloon animations, sound effects, export & share.</div>
      </div>
    </div>
  </div>

  <!-- external libs for export & sounds -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>

  <script>
    // Globals
    const cakeWrap = document.getElementById('cakeWrap');
    const halfLeft = document.getElementById('halfLeft');
    const halfRight = document.getElementById('halfRight');
    const slice = document.getElementById('slice');
    const confettiRoot = document.getElementById('confetti');
    const balloonsRoot = document.getElementById('balloons');
    const wishSection = document.getElementById('wish');
    const card = document.getElementById('card');

    // Sound setup (Howler)
    const soundOn = {val:true};
    const sounds = {
      cut: new Howl({src:['https://cdn.jsdelivr.net/gh/ale-mi/sounds@main/cut.mp3'], volume:0.6}),
      pop: new Howl({src:['https://cdn.jsdelivr.net/gh/ale-mi/sounds@main/pop.mp3'], volume:0.7}),
      confetti: new Howl({src:['https://cdn.jsdelivr.net/gh/ale-mi/sounds@main/confetti.mp3'], volume:0.5})
    };

    // Utility to play if sound not muted
    function play(name){ if(soundOn.val && sounds[name]) sounds[name].play(); }

    // Confetti particle system (canvas-based)
    function burstConfetti(x, y){
      // x,y in local percent (0-1)
      const rect = confettiRoot.getBoundingClientRect();
      const count = 60;
      for(let i=0;i<count;i++){
        const el = document.createElement('div');
        el.className='confetti-piece';
        const w = 8 + Math.random()*10; el.style.width = w+'px'; el.style.height = (w*1.2)+'px';
        const colors = ['#ff6b6b','#ffd166','#7cc6ff','#9ef5c1','#d6a4ff','#ffd8ea'];
        el.style.background = colors[Math.floor(Math.random()*colors.length)];
        // position
        el.style.left = (x*100) + '%'; el.style.top = (y*100) + '%';
        confettiRoot.appendChild(el);
        const angle = Math.random()*Math.PI*2;
        const speed = 180 + Math.random()*240;
        const vx = Math.cos(angle)*speed; const vy = Math.sin(angle)*speed - 200;
        el.animate([
          { transform: 'translate(0px,0px) rotate(0deg)', opacity:1 },
          { transform: `translate(${vx}px, ${vy}px) rotate(${Math.random()*720}deg)`, opacity:1 },
          { transform: `translate(${vx*1.4}px, ${vy*1.6 + 260}px) rotate(${Math.random()*1080}deg)`, opacity:0 }
        ], { duration: 1200 + Math.random()*900, easing: 'cubic-bezier(.2,.9,.2,1)' });
        setTimeout(()=>el.remove(), 2200);
      }
      play('confetti');
    }

    // Balloons launch
    function launchBalloons(x,y){
      balloonsRoot.innerHTML='';
      const types=['blue','pink','yellow','green','blue'];
      types.forEach((t,i)=>{
        const b = document.createElement('div'); b.className='balloon';
        b.style.width = (56 + Math.random()*36)+'px'; b.style.height = (74 + Math.random()*36)+'px';
        // color
        if(t==='blue') b.style.background = 'linear-gradient(180deg,#7cc6ff,#5aaef0)';
        if(t==='pink') b.style.background = 'linear-gradient(180deg,#ff9ac1,#ff6b9a)';
        if(t==='yellow') b.style.background = 'linear-gradient(180deg,#ffe28a,#ffd166)';
        if(t==='green') b.style.background = 'linear-gradient(180deg,#9ef5c1,#5fdd9a)';
        // position
        b.style.left = (x*100 + (i-2)*6) + '%'; b.style.bottom = (Math.max(0,(1-y))*100 - 6) + '%';
        balloonsRoot.appendChild(b);
        const delay = i*130;
        const drift = (Math.random()-0.5)*120;
        b.animate([
          { transform: 'translateY(0px) scale(.9) rotate(0deg)', opacity:0 },
          { transform: `translateY(-560px) translateX(${drift}px) scale(1) rotate(${(Math.random()-0.5)*20}deg)`, opacity:1 }
        ], { duration: 2600 + i*300 + Math.random()*600, delay, easing: 'cubic-bezier(.2,.9,.2,1)', fill:'forwards' });
      });
      play('pop');
    }

    // Crumbs emitter
    function emitCrumbs(localX, localY){
      for(let i=0;i<10;i++){
        const c = document.createElement('div'); c.style.position='absolute';
        const size = 4 + Math.random()*10; c.style.width = size+'px'; c.style.height = (size*0.6)+'px'; c.style.borderRadius='3px'; c.style.background='#d69a78';
        c.style.left = (localX + (Math.random()-0.5)*40)+'px'; c.style.top = (localY + (Math.random()-0.5)*30)+'px';
        c.style.opacity = 1; cakeWrap.appendChild(c);
        const vx = (Math.random()-0.5)*220; const vy = -80 - Math.random()*220;
        c.animate([{ transform:'translate(0px,0px) rotate(0deg)', opacity:1 },{ transform:`translate(${vx}px, ${vy}px) rotate(${Math.random()*360}deg)`, opacity:0 }],{duration:800 + Math.random()*900, easing:'cubic-bezier(.2,.9,.2,1)', fill:'forwards'});
        setTimeout(()=>c.remove(), 1800);
      }
    }

    // Main interactive cut logic
    let cutting = false;
    function cutAt(clientX, clientY, angleDelta=0){
      if(cutting) return; cutting=true;
      const rect = cakeWrap.getBoundingClientRect();
      const x = clientX - rect.left; const y = clientY - rect.top;
      if(x<10 || x>rect.width-10) { cutting=false; return; }

      // compute normalized
      const nx = x/rect.width; const ny = y/rect.height;

      // update clip-paths for halves
      const percent = (nx*100).toFixed(2);
      halfLeft.style.clipPath = `polygon(0 0, ${percent}% 0, ${percent}% 100%, 0 100%)`;
      halfRight.style.clipPath = `polygon(${percent}% 0, 100% 0, 100% 100%, ${percent}% 100%)`;

      // position slice
      slice.style.left = (x - 80) + 'px'; slice.style.top = (y - 20) + 'px'; slice.style.opacity = 1;

      // animate halves moving outwards with rotation derived from angleDelta
      const leftMove = - (120 + Math.abs(angleDelta)*2); const rightMove = (120 + Math.abs(angleDelta)*2);
      halfLeft.animate([{ transform:'translateX(0px) rotate(0deg)' },{ transform:`translateX(${leftMove}px) rotate(${ -12 - angleDelta }deg)` }],{duration:900,easing:'cubic-bezier(.2,.9,.2,1)',fill:'forwards'});
      halfRight.animate([{ transform:'translateX(0px) rotate(0deg)' },{ transform:`translateX(${rightMove}px) rotate(${ 12 + angleDelta }deg)` }],{duration:900,easing:'cubic-bezier(.2,.9,.2,1)',fill:'forwards'});

      // slice flies out
      slice.animate([{ transform:'translateY(0px) rotate(0deg) scale(1)' },{ transform:`translate(${rightMove/1.6}px, -220px) rotate(${20 + angleDelta}deg) scale(.98)`, opacity:1 },{ transform:`translate(${rightMove/1.2}px, -360px) rotate(${40 + angleDelta}deg) scale(.85)`, opacity:0 }],{duration:1200,easing:'cubic-bezier(.2,.9,.2,1)'});

      // crumbs & particles
      emitCrumbs(x,y);
      burstConfetti(nx, ny);
      launchBalloons(nx, ny);
      play('cut');

      // reveal wish (delayed)
      setTimeout(()=>{ card.classList.add('reveal'); play('pop'); cutting=false; }, 700);
    }

    // Helpers for pointer interaction: click to cut, drag to set angle
    let isPointerDown=false; let startX=0, startY=0;
    cakeWrap.addEventListener('pointerdown', (ev)=>{ isPointerDown=true; startX=ev.clientX; startY=ev.clientY; });
    window.addEventListener('pointerup', (ev)=>{ if(!isPointerDown) return; isPointerDown=false; const dx = ev.clientX - startX; const dy = ev.clientY - startY; const ang = Math.round(dx/6); cutAt(ev.clientX, ev.clientY, ang); });

    // Reset
    document.getElementById('reset').addEventListener('click', ()=>{
      // clear animations & elements
      halfLeft.style.clipPath='polygon(0 0,50% 0,50% 100%,0 100%)'; halfRight.style.clipPath='polygon(50% 0,100% 0,100% 100%,50% 100%)';
      halfLeft.style.transform='none'; halfRight.style.transform='none'; slice.style.opacity=0; confettiRoot.innerHTML=''; balloonsRoot.innerHTML=''; card.classList.remove('reveal');
    });

    // export as e-card image
    document.getElementById('downloadBtn').addEventListener('click', ()=>{
      // temporarily show wish
      card.classList.add('reveal');
      html2canvas(card,{scale:2, useCORS:true}).then(canvas=>{
        const link = document.createElement('a'); link.download = 'Shweta_birthday_card.png'; link.href = canvas.toDataURL('image/png'); link.click();
        card.classList.remove('reveal');
      });
    });

    // fullscreen
    document.getElementById('fullBtn').addEventListener('click', ()=>{
      if(!document.fullscreenElement) document.documentElement.requestFullscreen().catch(()=>{});
      else document.exitFullscreen();
    });

    // sound toggle
    document.getElementById('soundToggle').addEventListener('click', function(){ soundOn.val = !soundOn.val; this.textContent = soundOn.val ? 'Mute' : 'Unmute'; });

    // randomize theme (colors) â€” premium look variations
    document.getElementById('randomize').addEventListener('click', ()=>{
      const palettes = [ ['#ff6b6b','#ffd166','#f5c06b','#6b3520'], ['#6ec1a0','#ffd166','#f7c97c','#5b3a2b'], ['#7cc6ff','#ffd166','#f5b86b','#4b2b1a'] ];
      const p = palettes[Math.floor(Math.random()*palettes.length)];
      document.documentElement.style.setProperty('--accent', p[0]); document.documentElement.style.setProperty('--accent2', p[1]); document.documentElement.style.setProperty('--gold', p[2]); document.documentElement.style.setProperty('--choc', p[3]);
    });

    // share (simple)
    document.getElementById('share').addEventListener('click', ()=>{
      const text = encodeURIComponent('Happy Birthday Shweta! ðŸŽ‰ â€” Open this interactive card.');
      window.open(`https://twitter.com/intent/tweet?text=${text}`,'_blank');
    });

    // small UX: cut by clicking center by default
    cakeWrap.
